# Object-C - Swift基础2

## 类和结构体

### 比较结构体和类

Swift 中结构体和类有很多共同点，二者皆可：

- 定义属性以存储值
- 定义方法以提供功能
- 定义下标以提供下标语法访问其值
- 定义构造器以设置其初始化状态
- 通过扩展以增加默认实现功能
- 遵循协议以提供某种标准功能
更多信息请参阅 属性，方法，下标，构造过程，扩展 和 协议。

类有有一些结构体没有的额外功能：

- 继承让一个类可以继承另一个类的特征
- 类型转换让你在运行时可以检查和解释一个类实例
- 析构器让一个类的实例可以释放任何被其所分配的资源
- 引用计数允许对一个类实例进行多次引用
更多信息请参阅 继承，类型转换，析构过程 和 自动引用计数。

使用类的额外功能其代价就是增加了复杂性。一般来说，更推荐结构体和枚举，因为他们更加容易进行推断，并且适当或必要时使用类。实际上，这意味着将会使用结构体和枚举来定义大多数自定义数据类型。更多比较详情请参阅 抉择在结构体和类之间。


以下是定义结构体和类的示例:
``` swift
struct Resolution {
    var width = 0
    var height = 0
}
class VideoMode {
    var resolution = Resolution()
    var interlaced = false
    var frameRate = 0.0
    var name: String?
}
```
上面的例子定义了一个名为 Resolution 的结构体，用于描述基于像素的显示分辨率。这个结构体有两个存储属性分别名为 width 和 height。 存储属性是与结构体或类绑定并存储为其一部分的常量或变量。由于设置这两个属性的初始值为 0 所以其类型被推断为  Int 。

上面的例子还定义了一个名为 VideoMode 的类，用于描述视频的指定显示模式，这个类有四个为存储属性的变量。第一个，resolution，是 Resolution 结构体初始化的一个实例，其类型被推断为 Resolution。至于其他三个属性，新的 VideoMode 实例会把 interlaced 设置为 false（逐行扫描视频），播放帧数 frameRate 设置为 0.0，和一个名为 name 关联值类型是 String 的 可选类型。由于是可选类型，name 默认值自动为 nil，或说『无 name 值』。


## 实例方法

实例方法 是属于特定类、结构或枚举实例的函数。它们的功能是提供访问和修改实例属性的方法，或提供与实例目的相关的功能。实例方法与函数具有完全相同的语法，如 函数 中所述。

你在其所属类型的开始和结束括号内编写实例方法。实例方法可以隐式访问该类型的所有其它实例方法和属性。实例方法只能被它所属类型的实例调用。如果没有实例，不能单独调用它。

下面是一个简单 Counter 类的示例，可用于计算操作发生的次数：
``` swift
class Counter {
    var count = 0
    func increment() {
        count += 1
    }
    func increment(by amount: Int) {
        count += amount
    }
    func reset() {
        count = 0
    }
}
```
###  Counter 类中定义了三个实例方法

- increment() 将计数器增加 1 。
- increment(by: Int) 将计数器增加指定的值。
- reset() 将计数器重置为 0。
 Counter 类中还声明了一个可变的属性  count ，用来记录计数器当前的值。

和调用属性一样，你可以使用点语法来调用实例方法：
``` swift
let counter = Counter()
// 计数器初始值为 0
counter.increment()
// 计数器的值现在为 1
counter.increment(by: 5)
// 计数器的值现在为 6
counter.reset()
// 计数器的值现在为 0
```
方法的参数可以同时拥有一个参数名称（在方法内使用）和一个参数标签（在调用方法时使用），和 函数的参数标签和参数名 中描述的一样。方法的参数也是如此，因为方法也是函数只不过它和类相关联。


## 构造器

构造器 在创建某类实例时调用。其最简单的形式用 init 关键字来写，就像一个不带参数的实例方法：
``` swift
init() {
    // 在这执行初始化设置
}
```
下面的例子定义了一个名为 Fahrenheit 的新结构体，用于保存华氏温度。Fahrenheit 结构体有一个 Double 类型的存储属性 temperature：
``` swift
struct Fahrenheit {
    var temperature: Double
    init() {
        temperature = 32.0
    }
}
var f = Fahrenheit()
print("The default temperature is \(f.temperature)° Fahrenheit")
// 打印 "The default temperature is 32.0° Fahrenheit"
```
这个结构体定义了一个没有参数的构造器 init，并将存储属性 temperature 的值初始化为 32.0 ( 水冰点的华氏温度 )。


## 析构器是如何运作的

当不再需要某一个实例时，Swift 会自动销毁该实例，以释放资源。 Swift 通过 自动引用计数（ ARC ）来管理实例内存，就如 自动引用计数 中所述。通常在实例释放时，你无需行手执动清理。但是，当你在使用自己的资源时，可能需要自己执行一些额外的清理。例如，如果你创建了一个自定义类以打开文件并向其写入一些数据，则可能需要在销毁类实例之前关闭该文件。

在类的定义中, 类最多只能有一个析构器。 析构器不接受任何参数，并且没有括号：
``` swift
deinit {
    //执行析构器
}
```
在实例销毁之前，会自动调用析构器。你不能自己调用析构器。父类的析构器由其子类继承，父类析构器会在子类析构器实现的末尾自动调用。即使子类不提供自己的析构器，父类析构器也会被调用。

因为实例在调用析构器之后才会被释放，所以析构器可以访问调用它的实例的所有属性，并可以根据这些属性修改其行为（例如查找需要关闭的文件的名称） ）。